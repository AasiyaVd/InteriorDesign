<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
  <title>La ObsidianÃ© | Preview</title>

  <!-- Standard favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

<!-- Apple iOS -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

<!-- Android / Chrome -->
<link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">

<!-- Microsoft -->
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-150x150.png">

<!-- Theme color for mobile browsers -->
<meta name="theme-color" content="#ffffff">

  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
  integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
/>
<style>
body{
  margin:0;
  background:linear-gradient(180deg,#faf9f7,#f2f1ee);
}

/* ================= CONTAINER ================= */
.preview-wrapper{
  max-width:1200px;
  margin:90px auto 80px;
  padding:0 20px;
  text-align:center;
}

.preview-title{
  font-size:35px;
  font-weight:100;
  margin-bottom:6px;
  font-family: 'Cormorant Garamond', serif;
   color: rgba(75, 0, 7); 

}

.preview-sub{
  font-size:15px;
  color:#777;
  margin-bottom:10px;
  font-family: poppins;
}

/* ================= BEFORE AFTER ================= */
.before-after-container{
  position:relative;
  width:100%;
  max-width:1100px;
  margin:0 auto;
  height:520px;
  border-radius:24px;
  overflow:hidden;

  background:rgba(255,255,255,0.6);
  backdrop-filter:blur(14px);

  box-shadow:
    0 30px 60px rgba(0,0,0,0.12),
    inset 0 0 0 1px rgba(255,255,255,0.4);
}

/* images */
.before-img,
.after-img{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  display:none;
  z-index: 1;
}

.after-img{
  clip-path:inset(0 0 0 50%);
  z-index: 2;
}

/* slider */
.slider{
  position:absolute;
  top:0;
  left:50%;
  width:3px;
  height:100%;
  background:rgba(255,255,255,0.9);
  cursor:ew-resize;
  z-index:5;
}

.slider::before{
  content:'â‡†';
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:42px;
  height:42px;
  background:#000;
  color:#fff;
  font-size:14px;
  font-weight:600;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  border:3px solid #fff;
  box-shadow:0 10px 25px rgba(0,0,0,0.3);
}

/* labels */
.labels{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:0;
  z-index:30; /* always above images */
}
.label{
  position:absolute;
  top:24px;
  padding:10px 22px;
  font-size:13px;
  font-weight:600;
  background: #000; 
  color:#fff;
  border-radius:40px;
  white-space:nowrap;   /* ðŸ”¥ prevents BAforee issue */
  pointer-events: none;
  user-select: none;
}

.label.before{ 
left:24px; 
}
.label.after{ 
right:24px; 
left:auto; /* âœ… FIX */
background:linear-gradient(135deg,#000,#333); 
}




/* ===== PREMIUM CENTERED ACTION BAR ===== */
.premium-actions{
  margin-top:32px;
  display:grid;
  grid-template-columns:auto 1fr auto;
  align-items:center;
  gap:26px;
  max-width:560px;
  margin-left:auto;
  margin-right:auto;
}

/* SIDE ICON BUTTONS */
.action-side{
  width:44px;
  height:44px;
  border-radius:50%;
  background:rgba(255,255,255,0.6);
  backdrop-filter:blur(10px);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  box-shadow:0 8px 20px rgba(0,0,0,0.15);
  transition:transform .3s, box-shadow .3s, opacity .3s;
}

.action-side:hover{
  transform:translateY(-2px);
  box-shadow:0 14px 30px rgba(0,0,0,0.22);
  opacity:0.85;
}

/* SVG ICON STYLE */
.action-side .icon{
  width:18px;
  height:18px;
  stroke:#111;
  stroke-width:1.6;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
}

/* CENTER PRIMARY CTA */
.action-main{
  justify-self:center;
  padding:15px 42px;
  border-radius:50px;
  background:#000;
  color:#fff;
  font-size:14px;
  letter-spacing:0.4px;
  cursor:pointer;
  box-shadow:0 18px 40px rgba(0,0,0,0.28);
  transition:transform .3s, box-shadow .3s;
}

.action-main:hover{
  transform:translateY(-2px);
  box-shadow:0 24px 55px rgba(0,0,0,0.35);
}






/* NAVBAR */
.navbar{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:70px;
  background:rgba(75,0,7);
  color:#d0b75b;
  display:flex;
  align-items:center;
  padding:0 60px;
  z-index:1000;
  font-family:'Cormorant Garamond', serif;
}

.logo-group{
  display:flex;
  align-items:center;
  gap:10px;
}

.crown-img{
  height:48px;
}

.label-img{
  height:30px;
}

    .menu {
      list-style: none;
      display: flex;
      gap: 25px;
      margin-left: 580px;

    }
.menu a{
  color:#d0b75b;
  font-size:16px;
  text-decoration:none;
}

.menu a:hover{
  opacity:0.7;
}

.user-icon{
  width:22px;
  height:22px;
  stroke:#d0b75b;
  stroke-width:1.4;
  fill:none;
}
/* SVG ICON */
.user-icon {
  width: 22px;
  height: 22px;
  stroke: currentColor;   /* INHERITS NAVBAR COLOR */
  stroke-width: 1.4;
  fill: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}




       .logout-btn {
  background: none;
  border: none;
  cursor: pointer;
}

.logout-icon {
  width: 22px;
  height: 22px;
  stroke: #d0b75b ;
  stroke-width: 1.6;
  fill: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.logout-btn:hover .logout-icon {
  color:  #d0b75b ;
  opacity: 0.6;
  transform: translateX(2px);
}

/* ================= ACTION DOCK ================= */
.action-dock{
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  align-items:center;
  gap:22px;
  padding:18px 28px;
}

/* side buttons */
.dock-btn{
  width:46px;
  height:46px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:transform .3s, background .3s;
}
.dock-btn:hover{
  transform:translateY(-3px);
  background:rgba(255,255,255,0.18);
}
.dock-btn svg{
  width:18px;
  height:18px;
  stroke:#000;
  fill:none;
  stroke-width:1.6;
}

/* main CTA */
.dock-main{
  padding:14px 46px;
  border-radius:40px;
  background:#000;
  color:#fff;
  font-size:14px;
  font-weight:500;
  letter-spacing:0.5px;
  cursor:pointer;
  transition:transform .3s, box-shadow .3s;
  box-shadow:0 15px 40px rgba(255,255,255,0.3);
}
.dock-main:hover{
  transform:translateY(-3px);
  box-shadow:0 25px 60px rgba(255,255,255,0.45);
}
html, body {
  height: 100%;
  overflow: hidden;
}

/* ðŸš« Disable text/image selection inside preview */
.before-after-container,
.before-after-container * {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

</style>

</style>
</head>
<body>
<script src="auth.js"></script>

<script>

  // ðŸ”„ Navbar auth state
  document.addEventListener("DOMContentLoaded", setupNavbarAuth);
</script>

  <nav class="navbar">
    <a href="home.html">
  <div class="logo-group">
    <img class="crown-img" src="crown.png" alt="Crown Logo">
    <img class="label-img" src="label.png" alt="La ObsidianÃ©">
  </div>
</a>
  <ul class="menu">
      <li><a href="#">AI INSIGHTS </a></li>
      <li><a href="template.html">DESIGN</a></li>
      <li><a href="about.html">ABOUT</a></li>
      <li><a href="contact.html">CONTACT</a></li>
   <li id="signupNav"><a href="signup.html">SIGN UP</a></li>

<li class="user-dashboard" id="dashboardNav" style="display:none">
  <a href="dashboard.html" aria-label="User Dashboard">
    <svg class="user-icon" viewBox="0 0 24 24" fill="none">
      <circle cx="12" cy="8" r="4"/>
      <path d="M4 20c0-4 4-6 8-6s8 2 8 6"/>
    </svg>
  </a>
</li>

<li id="logoutNav" style="display:none">
  <button class="logout-btn" id="logoutBtn">
    <svg class="logout-icon" viewBox="0 0 24 24" fill="none">
      <path d="M16 17l5-5-5-5"/>
      <path d="M21 12H9"/>
      <path d="M13 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h8"/>
    </svg>
  </button>
</li>


    </ul>
  </ul>
</nav>

<div class="preview-wrapper">
 

  <div class="before-after-container" id="container">
    <div class="labels">
    <span class="label before">Before</span>
    <span class="label after">After</span>
  </div>

    <img id="beforeImg" class="before-img">
    <img id="afterImg" class="after-img">

    <div class="slider" id="slider"></div>
  </div>


  

  
    <!-- ACTION DOCK -->
   <div class="action-dock">

  <!-- DOWNLOAD (LEFT) -->
  <div class="dock-btn" onclick="downloadDesign()" title="Download">
    <svg viewBox="0 0 24 24">
      <path d="M12 3v12"/>
      <path d="M7 10l5 5 5-5"/>
      <path d="M5 21h14"/>
    </svg>
  </div>

  <!-- MAIN CTA -->
  <div class="dock-main" onclick="goMakeItReal()">
    Make It Real
  </div>

  <!-- SAVE (RIGHT) -->
  <div class="dock-btn" onclick="saveDesign()" title="Save">
    <svg viewBox="0 0 24 24">
      <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
      <path d="M17 21v-8H7v8"/>
      <path d="M7 3v5h8"/>
    </svg>
  </div>

</div>






  
<script>
const beforeImg = document.getElementById("beforeImg");
const afterImg  = document.getElementById("afterImg");
const slider    = document.getElementById("slider");
const labels    = document.querySelector(".labels");
const container = document.getElementById("container");

/* ===== LOAD PREVIEW IMAGES ===== */
const beforeSrc = sessionStorage.getItem("preview_before");
const afterSrc  = sessionStorage.getItem("preview_after");

if (!beforeSrc || !afterSrc) {
  alert("Preview data missing. Please generate again.");
  window.location.href = "AI.html";
}

beforeImg.src = beforeSrc;
afterImg.src  = afterSrc;

beforeImg.style.display = "block";
afterImg.style.display  = "block";
labels.style.display    = "block";

/* ===== DEFAULT SLIDER STATE ===== */
slider.style.left = "50%";
afterImg.style.clipPath = "inset(0 0 0 50%)";

/* ===== SLIDER DRAG ===== */
let dragging = false;

slider.addEventListener("mousedown", () => dragging = true);
window.addEventListener("mouseup", () => dragging = false);

window.addEventListener("mousemove", (e) => {
  if (!dragging) return;

  const rect = container.getBoundingClientRect();
  let x = e.clientX - rect.left;
  x = Math.max(0, Math.min(x, rect.width));

  const percent = (x / rect.width) * 100;
  slider.style.left = percent + "%";
  afterImg.style.clipPath = `inset(0 0 0 ${percent}%)`;
});
</script>


<script>
/* ================= BUTTON ACTIONS ================= */

/* ðŸ“¥ DOWNLOAD AFTER IMAGE */
function downloadDesign() {
  if (!afterImg.src) {
    alert("No design to download.");
    return;
  }

  const link = document.createElement("a");
  link.href = afterImg.src;
  link.download = "la-obsidiane-design.png";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

/* ðŸš€ MAKE IT REAL */
function goMakeItReal() {
  // pass AFTER image to next page
  sessionStorage.setItem("final_design", afterImg.src);
  window.location.href = "make-it-real.html";
}

/* ðŸ’¾ SAVE */
async function saveDesign() {
  const token = sessionStorage.getItem("token"); // âœ… FIX 1

  if (!token) {
    alert("Please login to save designs.");
    return;
  }

const payload = {
  style: sessionStorage.getItem("ai_style"),
  roomType: sessionStorage.getItem("ai_roomType"),
  colorMood: sessionStorage.getItem("ai_colorMood"),
  lighting: sessionStorage.getItem("ai_lighting"),
  beforeImage: sessionStorage.getItem("preview_before"),
  afterImage: sessionStorage.getItem("preview_after")
};


  if (!payload.style || !payload.roomType || !payload.beforeImage) {
    alert("Design data incomplete. Please generate again.");
    return;
  }

  try {
    const res = await fetch("/api/ai-design/save", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${token}`
      },
      body: JSON.stringify(payload)
    });

    const data = await res.json();

    if (!res.ok) {
      alert(data.message || "Failed to save design");
      return;
    }

    alert("âœ¨ Design saved to dashboard!");
  } catch (err) {
    console.error(err);
    alert("Server error while saving.");
  }
}


</script>

</body>
</html>